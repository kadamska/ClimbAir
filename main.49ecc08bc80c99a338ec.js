"use strict";(self.webpackChunk_softrockspl_climbair=self.webpackChunk_softrockspl_climbair||[]).push([[792],{274:(t,e,n)=>{var r,a=n(848),i=n(468),s=n(307),o=n(816),c=n(378),l=function(){return l=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var a in e=arguments[n])Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t},l.apply(this,arguments)},d="f1f10124d8835f9f53a99e0425ea5f60",u=(0,o.xP)({reducerPath:"api",baseQuery:(0,c.cw)({}),tagTypes:["Spots","Weather","Forecast"],endpoints:function(t){return{getClimbingSpots:t.query({query:function(t){var e=t.radius,n=t.lat,r=t.lon;return{url:"https://overpass-api.de/api/interpreter",method:"POST",body:"\n          [out:json];\n          nw(around:".concat(e,",").concat(n,",").concat(r,')["sport"="climbing"];\n          (._;>;);\n          out body;\n        ')}},providesTags:function(t,e,n){return[{type:"Spots",id:"".concat(n.radius,"-").concat(n.lat,"-").concat(n.lon)}]},keepUnusedDataFor:86400,transformResponse:function(t){var e,n=t.elements.filter((function(t){return"node"===t.type})),r=n.filter((function(t){var e;return!(null===(e=t.tags)||void 0===e?void 0:e.name)})),a=n.filter((function(t){var e;return!!(null===(e=t.tags)||void 0===e?void 0:e.name)})),i=t.elements.filter((function(t){return"way"===t.type})).map((function(t){return e=r.find((function(e){return e.id==t.nodes[0]})),l(l({},t),{tags:l(l({},t.tags),{name:t.tags.name||"unnamed"}),lat:e.lat,lon:e.lon})}));return a.concat(i)}}),getCurrentWeather:t.query({query:function(t){var e=t.lat,n=t.lon;return"https://api.openweathermap.org/data/2.5/weather?lat=".concat(e,"&lon=").concat(n,"&units=metric&appid=").concat(d)},providesTags:function(t,e,n){return[{type:"Weather",id:"".concat(n.lat,"-").concat(n.lon)}]},keepUnusedDataFor:3600}),getForecast:t.query({query:function(t){var e=t.lat,n=t.lon;return{url:"https://api.openweathermap.org/data/2.5/forecast?lat=".concat(e,"&lon=").concat(n,"&units=metric&appid=").concat(d),method:"GET"}},providesTags:function(t,e,n){return[{type:"Forecast",id:"".concat(n.lat,"-").concat(n.lon)}]},keepUnusedDataFor:21600})}}}),p=u.useGetClimbingSpotsQuery,g=u.useGetCurrentWeatherQuery;u.useGetForecastQuery;const h=(0,s.U1)({reducer:(r={},r[u.reducerPath]=u.reducer,r),middleware:function(t){return t().concat(u.middleware)}});var m=n(338),f=n(540),x=n(162),v=n(344),b=n(489),y=n(870),j=n(481),w=n.n(j),k=n(389),S=n(927),M=n(980),P=n(272),z=w().icon({iconUrl:S,shadowUrl:M,iconRetinaUrl:P,iconSize:[25,41],iconAnchor:[13,0]});const C=function(t){var e=t.cluster.centralPoint,n=g({lat:e.lat,lon:e.lon}).data;if(!n||!n.weather||!n.main)return null;var r=n.weather[0].icon?"http://openweathermap.org/img/wn/".concat(n.weather[0].icon,".png"):null,i="".concat(Math.round(n.main.temp),"°C"),s='\n    <div style="display: flex; align-items: center;">\n      <img src="'.concat(r,'" alt="weather icon" style="width: 50px; height: 50px;" />\n      <span style="text-shadow: 1px 1px 1px #fff, -1px 1px 1px #fff, -1px -1px 1px #fff, 1px -1px 1px #fff">').concat(i,"</span>\n    </div>\n  "),o=r?new(w().DivIcon)({html:s,className:"",iconSize:[60,60],iconAnchor:[30,30]}):z;return(0,a.jsx)(b.p,{position:[e.lat,e.lon],icon:o})};var _=w().icon({iconUrl:S,shadowUrl:M,iconRetinaUrl:P,iconSize:[25,41],iconAnchor:[13,0]}),W=function(t){return"yes"===t.tags.indoor||"yes"===t.tags.building||"sports_centre"===t.tags.leisure},O=function(t){var e=t.spot;return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("h2",{children:e.tags.name}),(0,a.jsx)("div",{children:"Ścianka wspinaczkowa"}),e.tags.description&&(0,a.jsx)("div",{children:e.tags.description}),e.tags["addr:street"]&&(0,a.jsxs)("div",{children:[e.tags["addr:street"]," ",e.tags["addr:housenumber"]]}),e.tags["addr:city"]&&(0,a.jsxs)("div",{children:[e.tags["addr:postcode"]," ",e.tags["addr:city"]]}),e.tags.opening_hours&&(0,a.jsxs)("div",{children:["Czynne: ",e.tags.opening_hours]}),e.tags.phone&&(0,a.jsxs)("div",{children:["Telefon: ",e.tags.phone]}),e.tags.website&&(0,a.jsxs)("div",{children:["WWW: ",e.tags.website]}),e.tags.facebook&&(0,a.jsxs)("div",{children:["FB: ",e.tags.facebook]}),e.tags.height&&(0,a.jsxs)("div",{children:["Wysokość: ",e.tags.height,"m"]})]})},F=function(t){var e=t.spot;return console.log("SPOT",e),(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("h2",{children:e.tags.name}),e.tags.description&&(0,a.jsx)("div",{children:e.tags.description}),e.tags.climbing&&(0,a.jsxs)("div",{children:["Typ wspinania: ",e.tags.climbing]}),"yes"===e.tags["climbing:boulder"]&&(0,a.jsx)("div",{children:"Bouldery"}),"yes"===e.tags["climbing:bolted"]&&(0,a.jsx)("div",{children:"Drogi ubezpieczone"}),"yes"===e.tags["climbing:mixed"]&&(0,a.jsx)("div",{children:"Drogi mieszane"}),"yes"===e.tags["climbing:sport"]&&(0,a.jsx)("div",{children:"Drogi sportowe"}),"yes"===e.tags["climbing:trad"]&&(0,a.jsx)("div",{children:"Drogi tradowe (klasyczne)"}),e.tags["climbing:rock"]&&(0,a.jsxs)("div",{children:["Skała: ",e.tags["climbing:rock"]]}),e.tags["climbing:grade:french:min"]&&(0,a.jsxs)("div",{children:["Min. trudność: ",e.tags["climbing:grade:french:min"]]}),e.tags["climbing:grade:french:max"]&&(0,a.jsxs)("div",{children:["Max. trudność: ",e.tags["climbing:grade:french:max"]]}),e.tags.rock&&(0,a.jsxs)("div",{children:["Skała: ",e.tags.rock]}),e.tags.height&&(0,a.jsxs)("div",{children:["Wysokość: ",e.tags.height,"m"]}),e.tags["climbing:routes"]&&(0,a.jsxs)("div",{children:["Liczba dróg: ",e.tags["climbing:routes"]]}),e.tags.url&&(0,a.jsxs)("div",{children:["URL: ",e.tags.url]})]})},T=function(t){var e=t.spot,n=t.onClose;return(0,a.jsxs)("div",{style:{padding:"10px",width:"300px",borderLeft:"1px solid grey",position:"relative"},children:[(0,a.jsx)("button",{onClick:n,style:{position:"absolute",top:"10px",right:"10px",background:"transparent",border:"none",fontSize:"18px",cursor:"pointer"},children:"×"}),W(e)?(0,a.jsx)(O,{spot:e}):(0,a.jsx)(F,{spot:e})]})};var U=n(635),q=n(997),D={en:{translation:JSON.parse('{"climbing_map":"Climbing Weather Map","radius":"Radius","meters":"meters","kilometers":"kilometers","current_weather":"Current Weather","forecast":"Forecast","temperature":"Temperature","precipitation":"Precipitation"}')},pl:{translation:JSON.parse('{"climbing_map":"Warun","radius":"Promień","meters":"metry","kilometers":"kilometry","current_weather":"Aktualna pogoda","forecast":"Prognoza","temperature":"Temperatura","precipitation":"Opady"}')}};U.Ay.use(q.A).use(k.r9).init({resources:D,fallbackLng:"pl",interpolation:{escapeValue:!1}});var A=document.getElementById("root");(0,m.H)(A).render((0,a.jsx)(i.Kq,{store:h,children:(0,a.jsx)((function(){var t=(0,f.useState)(!1),e=(t[0],t[1]),n=(0,f.useState)([51.1093,17.0386]),r=n[0],i=n[1],s=(0,f.useState)(100),o=s[0],c=s[1],l=(0,f.useState)(null),d=l[0],u=l[1],h=(0,k.Bd)().t;(0,f.useEffect)((function(){navigator.geolocation.getCurrentPosition((function(t){var e=t.coords,n=e.latitude,r=e.longitude;i([n,r])}),(function(t){console.error("Error getting user location:",t)}))}),[]);var m=p({radius:1e3*o,lat:r[0],lon:r[1]}).data,j=void 0===m?[]:m,w=function(t){var e=[];return t.forEach((function(t){for(var n,r,a,i,s,o=!1,c=0,l=e;c<l.length;c++){var d=l[c],u=d.centralPoint,p=d.members;if(n=u,void 0,void 0,void 0,a=((r=t).lat-n.lat)*Math.PI/180,i=(r.lon-n.lon)*Math.PI/180,s=Math.sin(a/2)*Math.sin(a/2)+Math.cos(n.lat*Math.PI/180)*Math.cos(r.lat*Math.PI/180)*Math.sin(i/2)*Math.sin(i/2),2*Math.atan2(Math.sqrt(s),Math.sqrt(1-s))*6371<=10){p.push(t),d.centralPoint={lat:(u.lat*p.length+t.lat)/(p.length+1),lon:(u.lon*p.length+t.lon)/(p.length+1)},o=!0;break}}o||e.push({centralPoint:{lat:t.lat,lon:t.lon},members:[t]})})),e}(j);return g(j.length?{lat:j[0].lat,lon:j[0].lon}:{lat:0,lon:0},{skip:0===j.length}).data,(0,a.jsxs)("div",{className:"App",style:{display:"flex"},children:[(0,a.jsxs)("div",{style:{flex:"1"},children:[(0,a.jsx)("h1",{children:h("climbing_map")}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("label",{children:[h("radius")," (",h("kilometers"),"):",(0,a.jsx)("input",{type:"number",value:o,onChange:function(t){return c(Number(t.target.value))},style:{marginLeft:"10px",marginRight:"10px"}})]}),(0,a.jsx)("button",{onClick:function(){return e(!1)},children:h("current_weather")}),(0,a.jsx)("button",{onClick:function(){return e(!0)},children:h("forecast")})]}),(0,a.jsxs)(x.W,{center:r,zoom:10,style:{height:"600px",width:"100%"},children:[(0,a.jsx)(v.e,{url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",attribution:'© <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'}),(0,a.jsx)(v.e,{url:"https://tile.openweathermap.org/map/precipitation_new/{z}/{x}/{y}.png?appid=".concat("f1f10124d8835f9f53a99e0425ea5f60")}),j.map((function(t,e){return(0,a.jsx)(b.p,{position:[t.lat,t.lon],icon:_,eventHandlers:{click:function(){u(t)}},zIndexOffset:1e3,children:(0,a.jsxs)(y.z,{children:[(0,a.jsxs)("b",{children:[t.tags.name," ",("yes"===t.tags.indoor||"yes"===t.tags.building||"sports_centre"===t.tags.leisure)&&(0,a.jsx)("span",{children:"(ścianka)"})]}),(0,a.jsx)("br",{})]})},e)})),w.map((function(t,e){return(0,a.jsx)(C,{cluster:t},e)}))]})]}),d&&(0,a.jsx)(T,{spot:d,onClose:function(){return u(null)}})]})}),{})}))}},t=>{t.O(0,[540],(()=>t(t.s=274))),t.O()}]);
//# sourceMappingURL=main.49ecc08bc80c99a338ec.js.map